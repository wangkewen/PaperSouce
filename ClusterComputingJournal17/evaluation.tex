\begin{figure}[!t]
\centering
\captionsetup{justification=centering}
\includegraphics[width=3in]{simjobs.png}
\caption{Execution Time for Different Number of Simulation Jobs}
\label{simjobs}
\end{figure}

\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Prediction Accuracy for Interference Among Same Jobs}
\label{table_samejob}
\centering
\begin{tabular}{c|c|c|c}
\hline
\bfseries JobName & \bfseries Job Number & \bfseries First Stage & \bfseries Whole Job\\
\hline\hline
PR & 2 & 0.97 & 0.80\\
& 3 & 0.96 & 0.85\\
& 4 & 0.92 & 0.82\\
\hline
KM & 2 & 0.75 & 0.70\\
& 3 & 0.71 & 0.68\\
& 4 & 0.98 & 0.92\\
\hline
LR & 2 & 0.74 & 0.78\\
& 3 & 0.79 & 0.81\\
& 4 & 0.97 & 0.97 \\
\hline
WC & 2 & 0.87 & 0.86\\
& 3 & 0.96 & 0.94\\
& 4 & 0.95 & 0.94\\
\hline
\end{tabular}
\end{table*}


\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for Four Interfered PageRank Jobs}
\label{pr20gprIII}
\centering
\begin{tabular}{l|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 \\
\hline \hline
Actual Time (s)
& 652.7
& 37.3 
& 32.3 
& 23.9 
& 23.2
& 58.8 \\
\hline
Predicted Time (s) 
& 594.3 
& 43.0 
& 10.6
& 5.4 
& 5.0 
& 28.3 \\
\hline
\end{tabular}
\end{table*}

\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for Four Interfered K-Means Jobs}
\label{km20gkmIII}
\centering
\begin{tabular}{l|r|r|r|r|r|r|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 & \bfseries 7 & \bfseries 8 & \bfseries 9 & \bfseries 10 & \bfseries 11 & \bfseries 12\\
\hline \hline
Actual Time (s)
& 688.4
& 7.1
& 19.9
& 8.1
& 16.5
& 7.4
& 15.9
& 7.2
& 15.8
& 7.0
& 15.6
& 7.0 \\
\hline
Predicted Time (s) 
& 708.3
& 7.4
& 25.2
& 18.1
& 22.9
& 9.7
& 23.6
& 8.4
& 23.2
& 9.2
& 24.8
& 6.2 \\
\hline
\end{tabular}
\end{table*}

\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for Four Interfered Logistic Regression Jobs}
\label{lr20glrIII}
\centering
\begin{tabular}{l|r|r|r|r|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 & \bfseries 7 & \bfseries 8 & \bfseries 9 & \bfseries 10 \\
\hline \hline
Actual Time (s)
& 649.6
& 7.3
& 7.5
& 7.3
& 7.4
& 7.2
& 7.5
& 7.2
& 7.5
& 7.4\\
\hline
Predicted Time (s) 
& 669.2
& 7.1
& 7.2
& 7.6
& 6.6
& 7.0
& 6.5
& 7.9
& 6.9
& 6.3 \\
\hline
\end{tabular}
\end{table*}


\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for Four Interfered WordCount Jobs}
\label{wc20gwcIII}
\centering
\begin{tabular}{l|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 \\
\hline \hline
Actual Time (s)
& 598.8
& 66.8 \\
\hline
Predicted Time (s) 
& 631.8
& 77.8 \\
\hline
\end{tabular}
\end{table*}


\nop{maifi
\begin{figure}[!htb]
\centering
\captionsetup{justification=centering}
\includegraphics[width=3in]{pr20g_prIII.png}
\caption{Execution Time Prediction for Four Interfered PageRank Jobs}
\label{pr20gprIII}
\end{figure}
\begin{figure}[!t]
\centering
\captionsetup{justification=centering}
\includegraphics[width=3in]{km20g_kmIII.png}
\caption{Execution Time Prediction for Four Interfered K-Means Jobs}
\label{km20gkmIII}
\end{figure}


\begin{figure}[!htb]
\centering
\captionsetup{justification=centering}
\includegraphics[width=3in]{lr20g_lrIII.png}
\caption{Execution Time Prediction for Four Interfered Logistic Regression Jobs}
\label{lr20glrIII}
\end{figure}
\begin{figure}[!t]
\centering
\captionsetup{justification=centering}
\includegraphics[width=3in]{wc20g_wcIII.png}
\caption{Execution Time Prediction for Four Interfered WordCount Jobs}
\label{wc20gwcIII}
\end{figure}
}







\section{Evaluation}
\label{evaluation}

\noindent
To evaluate the accuracy of our modeling framework and the performance of the job scheduling algorithm, we used a cluster of 6 machines. Each machine had 8 CPU cores (Intel(R) Xeon(R) CPU E5620, 2.40GHz) and 22 GB of RAM memory where each machine hosted 4 virtual machines. We used Xen hypervisor \cite{xen} to create up to four virtual machines on each physical machine. Each virtual machine was configured with 4GB of RAM memory and 1 CPU core. For the deployed Apache Spark platform, one machine served as the master node, and the remaining five machines served as the working nodes. We created multiple clusters leveraging virtual machines to execute multiple Apache Spark jobs in parallel. 


\noindent
In our evaluation, for prediction, first, we need to estimate the parameter $\beta_{n}$ in equation (\ref{beta}). Towards that, we implemented our own Apache Spark job and executed that on our cluster to obtain the execution time and resource consumption information. This simulation job consists of three stages executing distinct(), groupByKey(), and count() operation respectively. Distinct() implements a mapping function and parses the input data, groupByKey() processes the output of distinct() operation, and count() is a CPU intensive operation performing data summarization. This simulation job is executed with 2.5 GB of sample data where the first stage implementing the Distinct() operation involves significant I/O compared to the following two stages. To measure $\beta_{n}$, we executed $n$ ($n$=1,2,3,4) instances of this simulation job in parallel. As shown in Figure \ref{simjobs}, the effect of interference is significant for the first stage but minimal for the subsequent stages. 





\noindent
Once we estimated the value of $\beta_{n}$, subsequently, we used our formulation to predict the execution time for each stage of each job separately considering different execution scenarios and added up the prediction error for each stage to calculate the total prediction accuracy $R$ as below.
\begin{equation}
\label{predictaccuracy}
R = |1 -  \frac{\sum_{i=1}^{M}|PredictedTime_i - MeasuredTime_i|}{\sum_{j=1}^{M} MeasuredTime_{j}}|
\end{equation}
\noindent
Here $M$ is the number of stages in a job, $PredictedTime_i$ is the predicted execution time for $stage_i$, and \\
$MeasuredTime_i$ is the actual execution time of $stage_i$. Different evaluation scenarios are presented below.

\subsection{Interference Among Multiple Jobs of the Same Type Starting Simultaneously}

\noindent
In a shared cluster, multiple Apache Spark jobs running on separate virtual machines hosted on the same physical machine can cause significant interference, impacting the performance of each job. However, as different jobs may have different execution patterns and resource requirements, estimating the effect of interference on performance is nontrivial. As such, to demonstrate the generalizability of our work, we validated our model using four different Apache Spark jobs, namely, PageRank, K-Means, Logistic Regression and WordCount. The jobs vary in terms of the number of stages, the number of tasks, and the library functions they use to implement the job. For example, WordCount counts the word frequency for a given text file. K-Means implements a clustering algorithm, and Logistic Regression implements the Logistic Regression algorithm, which are examples of machine learning jobs. Finally, PageRank is an example of graph analyzing and processing jobs. For testing, we used the LiveJournal network dataset from SNAP \cite{snap} for PageRank, which is processed through mapping each node id onto a longer string to form a 20 GB input data set. K-Means and Logistic Regression used 20 GB of numerical Color-Magnitude Diagram data of galaxy from Sloan Digital Sky Survey (SDSS) \cite{sdss}. WordCount application used 20 GB of Wikipedia dump data.


\noindent
In this part of the evaluation, we present the accuracy of prediction while modeling the effect of interference among multiple jobs of the same type (e.g., interference between n instances of job x).





\noindent

For prediction, we first executed the sample job (e.g., Page rank) with 2.5 GB of input data which was extracted from the actual input data to collect the job execution profile. We ensured that no other job was running during this execution. The collected execution trace was then used to predict the execution time assuming no interference. Finally, we used our framework to adjust the prediction assuming interference. The prediction accuracy is summarized in Table~\ref{table_samejob}. In the table, PR, KM, LR, and WC refers to PageRank, K-Means, Logistic Regression, and WordCount application respectively. Column Job number (e.g., 2, 3, 4) indicates the number of jobs that were executed in parallel. For instance, a value of 2 indicates that two instances of the same job were executed in parallel. As can be seen, prediction accuracy is highest for Logistic regression application (97\%) and lowest for K-means (68\%).The predicted execution time and the actual execution time when we executed four instances of the same job in parallel are shown in Table~\ref{pr20gprIII}, Table~\ref{km20gkmIII}, Table~\ref{lr20glrIII}, and Table~\ref{wc20gwcIII} for PageRank, K-Means, Logistic Regression, and WordCount respectively. 

\noindent
The predicted execution time and the actual execution time when we executed four different jobs in parallel are shown in Table~\ref{pr20gkmlrwc}, Table~\ref{km20gprlrwc}, Table~\ref{lr20gprkmwc}, and Table~\ref{wc20gprkmlr} for PageRank, K-Means, Logistic Regression, and WordCount respectively. 



\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for PageRank Job Interfered with Other Three Jobs}
\label{pr20gkmlrwc}
\centering
\begin{tabular}{l|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 \\
\hline \hline
Actual Time (s)
&646.4
&36.9
&30.4
&22.3
&21.8
&26.9 \\
\hline
Predicted Time (s) 
&594.3
&43.0
&10.6
&5.4
&5.0
&28.3 \\
\hline
\end{tabular}
\end{table*}

\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for K-Means Job Interfered with Other Three Jobs}
\label{km20gprlrwc}
\centering
\begin{tabular}{l|r|r|r|r|r|r|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 & \bfseries 7 & \bfseries 8 & \bfseries 9 & \bfseries 10 & \bfseries 11 & \bfseries 12\\
\hline \hline
Actual Time (s)
&657.4
&7.1
&20.6
&9.6
&18.1
&7.3
&17.8
&7.0
&17.4
&7.1
&17.7
&7.1 \\
\hline
Predicted Time (s) 
&657.4
&7.4
&25.2
&18.1
&22.9
&9.7
&23.6
&8.4
&23.2
&9.2
&24.8
&6.2 \\
\hline
\end{tabular}
\end{table*}

\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for Logistic Regression Job Interfered with Other Three Jobs}
\label{lr20gprkmwc}
\centering
\begin{tabular}{l|r|r|r|r|r|r|r|r|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 & \bfseries 3 & \bfseries 4 & \bfseries 5 & \bfseries 6 & \bfseries 7 & \bfseries 8 & \bfseries 9 & \bfseries 10 \\
\hline \hline
Actual Time (s)
&651.9
&7.3
&7.4
&7.1
&7.9
&7.1
&7.3
&7.2
&7.7
&7.1\\
\hline
Predicted Time (s) 
&646.0
&7.1
&7.2
&7.6
&6.6
&7.0
&6.5
&7.9
&6.9
&6.3\\
\hline
\end{tabular}
\end{table*}


\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Execution Time Prediction for WordCount Job Interfered with Other Three Jobs}
\label{wc20gprkmlr}
\centering
\begin{tabular}{l|r|r}
\hline
\bfseries StageNo & \bfseries 1 & \bfseries 2 \\
\hline \hline
Actual Time (s)
&660.2
&40.2 \\
\hline
Predicted Time (s) 
&622.2
&77.8 \\
\hline
\end{tabular}
\end{table*}

\noindent
\begin{table*}[!t]
\renewcommand{\arraystretch}{1.3}
\caption{Prediction Accuracy for Two Different Jobs}
\label{table_twojobs}
\centering
\begin{tabular}{c|c|c|c}
\hline
\bfseries JobName & \bfseries Interfered Job & \bfseries First Stage & \bfseries Whole Job\\
\hline\hline
PR & KM & 0.91 & 0.79\\
& LR & 0.93 & 0.81\\
& WC & 0.99 & 0.85\\
\hline
KM & PR & 0.89 & 0.80\\
& LR & 0.80 & 0.73\\
& WC & 0.75 & 0.69\\
\hline
LR & PR & 0.97 & 0.97 \\
& KM & 0.73 & 0.77\\
& WC & 0.70 & 0.75\\ 
\hline
WC & PR & 0.96 & 0.87\\
& KM & 0.93 & 0.84\\
& LR & 0.96 & 0.88\\
\hline
\end{tabular}
\end{table*}


\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Prediction Accuracy for Three Different Jobs}
\label{table_threejobs}
\centering
\begin{tabular}{c|c|c|c}
\hline
\bfseries JobName & \bfseries Interfered Jobs & \bfseries First Stage & \bfseries Whole Job\\
\hline\hline
PR & KM, LR & 0.96 & 0.87\\
& KM, WC & 0.99 & 0.90\\
& LR, WC & 0.99 & 0.90\\
\hline
KM & PR, LR & 0.84 & 0.79\\
& PR, WC & 0.92 & 0.87\\
& LR, WC & 0.83 & 0.80\\
\hline
LR & PR, KM & 0.84 & 0.85\\
& PR, WC & 0.87 & 0.88\\
& KM, WC & 0.83 & 0.84\\
\hline
WC & PR, LR & 0.93 & 0.87\\
& PR, KM & 0.93 & 0.87\\
& KM, LR & 0.94 & 0.89\\
\hline
\end{tabular}
\end{table*}


\begin{table*}[!htb]
\renewcommand{\arraystretch}{1.3}
\caption{Prediction Accuracy for Four Different Jobs}
\label{table_fourjobs}
\centering
\begin{tabular}{c|c|c|c}
\hline
\bfseries JobName & \bfseries Interfered Jobs & \bfseries First Stage & \bfseries Whole Job\\
\hline\hline
PR & KM, LR, WC & 0.92 & 0.86\\
\hline
KM & PR, LR, WC & 0.99 & 0.95\\
\hline
LR & PR, KM, WC & 0.99 & 0.99 \\
\hline
WC & PR, KM, LR & 0.95 & 0.90\\
\hline
\end{tabular}
\end{table*}


\subsection{Interference Among Multiple Jobs of Different Types Starting Simultaneously}
\noindent
In this section, we present the accuracy of prediction while modeling the interference among $n$ different jobs concurrently, where $n$ was varied from 2 to 4. For example, when $n$ = 2, we execute two different jobs concurrently. The prediction accuracy while running two different jobs in parallel is summarized in Table~\ref{table_twojobs}. As shown in the table, there are a total of 6 combinations to consider. As can be seen, prediction accuracy ranges between 97\% and 69\% for the whole job, and between 99\% and 70\% for the first stage, which incurs the bulk of the execution time. 

\noindent
For $n$=3, we execute three different jobs concurrently. The prediction accuracy while running three different jobs in parallel is summarized in Table~\ref{table_threejobs}. As shown in the table, there are a total of 4 combinations to consider. As can be seen, prediction accuracy ranges between 90\% and 79\% for the whole job, and between 99\% and 83\% for the first stage.

\noindent
Finally, for $n$=4, we execute four different jobs concurrently. The prediction accuracy while running four different jobs in parallel is summarized in Table~\ref{table_fourjobs}. As shown in the table, there was only one combination to consider. As can be seen, prediction accuracy ranges between 99\% and 86\% for the whole job, and between 99\% and 92\% for the first stage.














